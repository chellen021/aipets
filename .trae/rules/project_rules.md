# 萌宠伙伴微信小程序项目规则

## 1. 项目概述

萌宠伙伴是一款基于微信小程序的虚拟宠物养成应用，通过AI技术将用户照片转化为独特的虚拟宠物，并提供丰富的互动养成体验和社交功能。

## 2. 技术栈

### 前端技术
- 基础框架：微信小程序原生框架
- 状态管理：MobX
- UI组件库：WeUI + 自定义业务组件
- CSS预处理器：SCSS
- 3D渲染：threejs-miniprogram

### 后端技术
- 编程语言：Node.js + TypeScript
- Web框架：NestJS
- 数据库：PostgreSQL (用户数据), MongoDB (宠物数据), Redis (缓存)
- 消息队列：RabbitMQ
- API网关：Apisix

### CMS技术
- 基础框架：Strapi
- 数据库：PostgreSQL

## 3. 开发规范

### 前端开发规范
- 组件化开发：优先封装可复用的UI组件和业务组件
- 代码规范：遵循统一的ESLint配置
- 性能优先：关注小程序的启动速度、页面加载速度
- 用户体验至上：严格按照设计规范实现UI/UX

### 后端开发规范
- API设计规范：RESTful风格，URL路径统一小写，使用中划线
- 版本控制：URL前缀 `/v1/`
- 请求/响应格式：统一使用JSON
- 身份认证：所有需要授权的接口通过JWT Token进行验证

### 数据库设计规范
- 用户库 (PostgreSQL): `users`, `user_login_logs`, `checkin_logs`, `products`, `orders`, `user_inventory`
- 宠物库 (MongoDB): `pets`, `pet_interactions`
- 缓存 (Redis): 用户会话、用户信息缓存、宠物信息缓存、排行榜数据

## 4. 测试规范

### 测试范围
- 功能测试：覆盖所有用户故事和功能点
- UI/UX测试：确保视觉和交互与设计规范一致
- API接口测试：验证所有API的正确性、性能和安全性
- 性能测试：测试小程序冷启动时间、页面加载速度
- 安全测试：覆盖API授权、XSS注入、文件上传漏洞等
- 兼容性测试：覆盖主流iOS和Android机型及不同微信版本

### 测试用例模板
```
| 测试用例ID | 模块 | 子模块/功能点 | 测试标题 | 前置条件 | 测试步骤 | 预期结果 | 实际结果 | 优先级 | 测试类型 | 备注 |
```

## 5. 部署规范

### 部署方案
- 小程序：微信官方发布流程
- 后端服务：Docker容器化后，通过Kubernetes进行编排
- 数据库：独立部署并进行专业配置和备份
- 静态资源：配置为由Nginx等Web服务器提供服务，或存储在对象存储

### CI/CD流程
- 配置自动化构建流程
- 配置自动化测试
- 配置自动化部署

## 6. 文档规范

### 文档列表
1. 需求规格说明书 (`require.md`)
2. 设计规范文档 (`design_spec.md`)
3. 系统架构设计文档 (`solution.md`)
4. 后端开发设计规范 (`backend.md`)
5. 前端开发设计规范 (`frontend.md`)
6. CMS开发设计规范 (`cms.md`)
7. API文档 (`api.md`)
8. 测试用例 (`testcase.md`)
9. 开发计划 (`plan.md`)
10. 项目规则 (`rules.md`)

### 文档更新
- 每次重大功能变更或架构调整后更新相关文档
- 文档版本号遵循语义化版本控制 (MAJOR.MINOR.PATCH)

## 7. 版本控制

### 分支模型
- 使用GitFlow工作流
  - `master`: 生产环境代码
  - `develop`: 集成开发分支
  - `feature/*`: 功能开发分支
  - `release/*`: 发布准备分支
  - `hotfix/*`: 紧急修复分支

### 提交信息规范
- 遵循Conventional Commits规范
- 示例：
  - `feat: 添加用户登录功能`
  - `fix: 修复登录页面样式问题`
  - `docs: 更新API文档`

## 8. 项目管理

### 开发流程
1. 需求分析与评审
2. 技术设计与评审
3. 任务拆分与排期
4. 代码开发与自测
5. 代码评审
6. 测试与修复
7. 发布与监控

### 会议制度
- 每日站会：15分钟，同步进度和问题
- 迭代计划会：规划下个迭代任务
- 评审会：评审需求和设计
- 回顾会：总结迭代经验教训